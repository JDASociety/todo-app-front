---
import { getSession } from 'auth-astro/server'
import Layout from '../../../layouts/TodoLayout.astro'
import { getTodos } from '../../../todo'
import TodoCard from '../../../components/TodoCard.astro'

const session = await getSession(Astro.request)

if (!session) {
	return Astro.redirect('/auth/login')
}

const { todos } = await getTodos({})
---

<Layout title="Lista de Tareas">
	<section>
		<ul class="todolist-container w-full">

			{ todos.map( todo => ( <TodoCard todo={todo}/> )) }

		</ul>
	</section>
</Layout>

